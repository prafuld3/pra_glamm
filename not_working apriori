lst=[]
k=0
m=0
for i in range(df1.shape[0]):
    if df1.iloc[i,0]==df1.iloc[i+1,0]:
        if i==df1.shape[0]-2:
            pass
        else:
            continue
        
    for j in range(k,i):
        if df1.iloc[j,1]==df1.iloc[j+1,1]:
            m+=1
            continue
        if df1.iloc[j-m,1]==df1.iloc[j+m-1,1]:
            lst.append(list(df1['product_name'][j-m:j+(m-1)].values))
            m=0
            
    k=j+2
    if i==df1.shape[0]-2:
        break
